import os
from dotenv import load_dotenv, find_dotenv, dotenv_values

# –Ø–≤–Ω–æ –∏—â–µ–º .env, –Ω–∞—á–∏–Ω–∞—è —Å —Ç–µ–∫—É—â–µ–π —Ä–∞–±–æ—á–µ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏, —á—Ç–æ–±—ã –Ω–∞–¥—ë–∂–Ω–æ –ø–æ–¥—Ö–≤–∞—Ç—ã–≤–∞—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
dotenv_path = os.getenv("DOTENV_PATH") or find_dotenv(usecwd=True)
if dotenv_path:
    # –ü—ã—Ç–∞–µ–º—Å—è –∑–∞–≥—Ä—É–∑–∏—Ç—å .env –∏–∑ –Ω–∞–π–¥–µ–Ω–Ω–æ–≥–æ –ø—É—Ç–∏ (—É—á–∏—Ç—ã–≤–∞–µ–º –≤–æ–∑–º–æ–∂–Ω—ã–π BOM)
    load_dotenv(dotenv_path=dotenv_path, encoding="utf-8-sig")
else:
    # –§–æ–ª–±—ç–∫ –Ω–∞ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –ø–æ–∏—Å–∫ –≤ —Å–ª—É—á–∞–µ, –µ—Å–ª–∏ find_dotenv –Ω–µ –Ω–∞—à—ë–ª —Ñ–∞–π–ª
    load_dotenv(encoding="utf-8-sig")

# –¢–æ–∫–µ–Ω –±–æ—Ç–∞
BOT_TOKEN = os.getenv("BOT_TOKEN")

# –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π —É—Å—Ç–æ–π—á–∏–≤—ã–π —Ñ–æ–ª–±—ç–∫: –≤—Ä—É—á–Ω—É—é –ø–∞—Ä—Å–∏–º .env, –µ—Å–ª–∏ –ø–æ –∫–∞–∫–æ–π-—Ç–æ –ø—Ä–∏—á–∏–Ω–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –Ω–µ –ø–æ–¥—Ö–≤–∞—Ç–∏–ª–∏—Å—å
if not BOT_TOKEN and dotenv_path and os.path.exists(dotenv_path):
    try:
        with open(dotenv_path, "r", encoding="utf-8-sig") as f:
            for raw_line in f.readlines():
                line = raw_line.strip()
                if not line or line.startswith("#"):
                    continue
                if "=" not in line:
                    continue
                key, value = line.split("=", 1)
                key = key.strip().lstrip("\ufeff")
                value = value.strip().strip('"').strip("'")
                if key and value and key not in os.environ:
                    os.environ[key] = value
        BOT_TOKEN = os.getenv("BOT_TOKEN")
    except Exception:
        # –¢–∏—Ö–æ –∏–≥–Ω–æ—Ä–∏—Ä—É–µ–º ‚Äî –æ—Å–Ω–æ–≤–Ω–æ–π –ø—É—Ç—å –∑–∞–≥—Ä—É–∑–∫–∏ —É–∂–µ –±—ã–ª –ø–æ–ø—ã—Ç–∞–ª—Å—è
        pass

# –§–∏–Ω–∞–ª—å–Ω—ã–π —Ñ–æ–ª–±—ç–∫: –∏—Å–ø–æ–ª—å–∑—É–µ–º –ø–∞—Ä—Å–µ—Ä dotenv_values (–±–µ–∑ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è)
if not BOT_TOKEN and dotenv_path and os.path.exists(dotenv_path):
    try:
        values = dotenv_values(dotenv_path)
        BOT_TOKEN = values.get("BOT_TOKEN", BOT_TOKEN)
    except Exception:
        pass

# –î–∞–Ω–Ω—ã–µ –º–µ–¥–∏—Ü–∏–Ω—Å–∫–æ–≥–æ —Ü–µ–Ω—Ç—Ä–∞
CLINIC_INFO = {
    "name": "–ú–µ–¥–∏—Ü–∏–Ω—Å–∫–∏–π —Ü–µ–Ω—Ç—Ä –ó–¥–æ—Ä–æ–≤—å–µ+",
    "address": "–≥. –ú–æ—Å–∫–≤–∞, —É–ª. –ú–µ–¥–∏—Ü–∏–Ω—Å–∫–∞—è, –¥. 15",
    "phone": "+7 (495) 123-45-67",
    "website": "https://zdorovie-plus.ru",
    "working_hours": "–ü–Ω-–ü—Ç: 8:00-20:00\n–°–±-–í—Å: 9:00-18:00",
    "map_url": "https://maps.google.com/?q=–ú–æ—Å–∫–≤–∞,—É–ª.–ú–µ–¥–∏—Ü–∏–Ω—Å–∫–∞—è,–¥.15",
    # –î–æ–ø. —Å–≤–µ–¥–µ–Ω–∏—è
    "email": "info@zdorovie-plus.ru",
    "description": (
        "–°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π –º–Ω–æ–≥–æ–ø—Ä–æ—Ñ–∏–ª—å–Ω—ã–π —Ü–µ–Ω—Ç—Ä, –≥–¥–µ —Å–æ—á–µ—Ç–∞—é—Ç—Å—è –æ–ø—ã—Ç–Ω—ã–µ —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç—ã, "
        "—Å–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–µ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ –∏ –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–π –ø–æ–¥—Ö–æ–¥. –ú—ã –ø—Ä–æ–≤–æ–¥–∏–º –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫—É, "
        "–ª–µ—á–µ–Ω–∏–µ –∏ –ø—Ä–æ—Ñ–∏–ª–∞–∫—Ç–∏–∫—É –ø–æ –∫–ª—é—á–µ–≤—ã–º –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è–º: —Ç–µ—Ä–∞–ø–∏—è, –∫–∞—Ä–¥–∏–æ–ª–æ–≥–∏—è, "
        "–Ω–µ–≤—Ä–æ–ª–æ–≥–∏—è, —Å—Ç–æ–º–∞—Ç–æ–ª–æ–≥–∏—è –∏ –¥—Ä. –ó–∞–±–æ—Ç–∏–º—Å—è –æ –∫–æ–º—Ñ–æ—Ä—Ç–Ω–æ–π –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ–π —Å—Ä–µ–¥–µ "
        "–¥–ª—è –ø–∞—Ü–∏–µ–Ω—Ç–æ–≤ –ª—é–±–æ–≥–æ –≤–æ–∑—Ä–∞—Å—Ç–∞."
    )
}

# –°–ø–µ—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –≤—Ä–∞—á–µ–π
SPECIALIZATIONS = [
    "–¢–µ—Ä–∞–ø–µ–≤—Ç",
    "–°—Ç–æ–º–∞—Ç–æ–ª–æ–≥", 
    "–ö–∞—Ä–¥–∏–æ–ª–æ–≥",
    "–ù–µ–≤—Ä–æ–ª–æ–≥",
    "–û—Ñ—Ç–∞–ª—å–º–æ–ª–æ–≥",
    "–û—Ä—Ç–æ–ø–µ–¥",
    "–ì–∏–Ω–µ–∫–æ–ª–æ–≥",
    "–£—Ä–æ–ª–æ–≥"
]

# –í—Ä–∞—á–∏ (–ø—Ä–∏–º–µ—Ä –¥–∞–Ω–Ω—ã—Ö)
DOCTORS = {
    "–¢–µ—Ä–∞–ø–µ–≤—Ç": [
        {
            "name": "–ò–≤–∞–Ω–æ–≤ –ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤–∏—á",
            "experience": "15 –ª–µ—Ç",
            "photo": "üë®‚Äç‚öïÔ∏è",
            "description": "–í—Ä–∞—á-—Ç–µ—Ä–∞–ø–µ–≤—Ç –≤—ã—Å—à–µ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏"
        },
        {
            "name": "–ü–µ—Ç—Ä–æ–≤–∞ –ê–Ω–Ω–∞ –°–µ—Ä–≥–µ–µ–≤–Ω–∞", 
            "experience": "12 –ª–µ—Ç",
            "photo": "üë©‚Äç‚öïÔ∏è",
            "description": "–í—Ä–∞—á-—Ç–µ—Ä–∞–ø–µ–≤—Ç –ø–µ—Ä–≤–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏"
        }
    ],
    "–°—Ç–æ–º–∞—Ç–æ–ª–æ–≥": [
        {
            "name": "–°–∏–¥–æ—Ä–æ–≤ –ü–µ—Ç—Ä –ê–ª–µ–∫—Å–∞–Ω–¥—Ä–æ–≤–∏—á",
            "experience": "20 –ª–µ—Ç", 
            "photo": "üë®‚Äç‚öïÔ∏è",
            "description": "–í—Ä–∞—á-—Å—Ç–æ–º–∞—Ç–æ–ª–æ–≥ –≤—ã—Å—à–µ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏"
        }
    ],
    "–ö–∞—Ä–¥–∏–æ–ª–æ–≥": [
        {
            "name": "–ö–æ–∑–ª–æ–≤–∞ –ï–ª–µ–Ω–∞ –í–ª–∞–¥–∏–º–∏—Ä–æ–≤–Ω–∞",
            "experience": "18 –ª–µ—Ç",
            "photo": "üë©‚Äç‚öïÔ∏è", 
            "description": "–í—Ä–∞—á-–∫–∞—Ä–¥–∏–æ–ª–æ–≥ –≤—ã—Å—à–µ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏"
        }
    ]
}

# –í—Ä–µ–º—è –ø—Ä–∏–µ–º–∞ (–ø—Ä–∏–º–µ—Ä)
AVAILABLE_TIMES = [
    "09:00", "09:30", "10:00", "10:30", "11:00", "11:30",
    "12:00", "12:30", "13:00", "13:30", "14:00", "14:30",
    "15:00", "15:30", "16:00", "16:30", "17:00", "17:30",
    "18:00", "18:30", "19:00", "19:30"
]

# ID –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ –¥–ª—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
ADMIN_ID = None  # –ë—É–¥–µ—Ç —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ

# –ù–∞—Å—Ç—Ä–æ–π–∫–∏ Google Sheets
# GOOGLE_SHEETS_ID - ID —Ç–∞–±–ª–∏—Ü—ã Google Sheets
# GOOGLE_SERVICE_ACCOUNT_JSON - JSON –∫–ª—é—á —Å–µ—Ä–≤–∏—Å–Ω–æ–≥–æ –∞–∫–∫–∞—É–Ω—Ç–∞ –≤ –æ–¥–Ω—É —Å—Ç—Ä–æ–∫—É (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
# GOOGLE_SERVICE_ACCOUNT_JSON - –ø—É—Ç—å –∫ JSON —Ñ–∞–π–ª—É —Å–µ—Ä–≤–∏—Å–Ω–æ–≥–æ –∞–∫–∫–∞—É–Ω—Ç–∞ (–¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏)
